/*!
 * zoomist.js v1.0.0
 * https://github.com/cotton123236/zoomist#readme
 *
 * Copyright 2021-present Wilson Wu
 * Released under the MIT license
 *
 * Date: 2021-11-03T15:35:23.529Z
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Zoomist=e()}(this,(function(){"use strict";var t={fill:"cover",src:"data-zoomist-src",wheelable:!0,draggable:!0,bounds:!0};const e="zoomist",i=!(!("undefined"!=typeof window&&void 0!==window.document)||!window.document.documentElement)&&"ontouchstart"in window.document.documentElement,o=i?"touchstart":"mousedown",n=i?"touchmove":"mousemove",a=i?"touchend touchcancel":"mouseup",s=t=>{const e={};for(const[i,o]of Object.entries(t))e[i]=o;return e},r=t=>t instanceof HTMLElement?t:document.querySelector(t),h=(t,e)=>{for(const[o,n]of Object.entries(e))t.style[o]="number"!=typeof(i=n)||isNaN(i)?n:`${n}px`;var i},c=t=>({x:i?t.touches[0].pageX:t.pageX,y:i?t.touches[0].pageY:t.pageY,clientX:i?t.touches[0].clientX:t.clientX,clientY:i?t.touches[0].clientY:t.clientY});var d={getContainerData(){return s(this.data.containerData)},getImageData(){return s(this.data.imageData)},zoom(t,e){const{image:i,data:o}=this,n=this.getImageData(),a=i.getBoundingClientRect(),s=n.width*(t+1),r=n.height*(t+1),c=e?(e.clientX-a.left)/n.width:.5,d=e?(e.clientY-a.top)/n.height:.5,l=(n.width-s)*c+n.left,m=(n.height-r)*d+n.top;o.imageData.width=s,o.imageData.height=r,o.imageData.left=l,o.imageData.top=m,h(i,{width:s,height:r,left:l,top:m})}},l=t=>{const{element:e,image:i,options:s,data:r}=t,{containerData:d,imageData:l}=r;window.addEventListener("resize",(function(){const i=e.offsetWidth/d.width,o=e.offsetHeight/d.height,n=l.width*i,a=l.height*o,s=l.left*i,r=l.top*o;d.width=e.offsetWidth,d.height=e.offsetHeight,l.width=n,l.height=a,l.left=s,l.top=r,h(t.image,{width:n,height:a,left:s,top:r})})),t.isDrag=!1,t.data.dragData={startX:0,startY:0,transX:0,transY:0},"contain"===s.fill&&s.bounds&&(s.bounds=!1);const{dragData:m}=r,u=e=>{if(!t.isDrag)return;const o=c(e).x,n=c(e).y,a=o-m.startX+m.transX,r=n-m.startY+m.transY,h=s.bounds?Math.min(Math.max(a,l.left),-l.left):a,d=s.bounds?Math.min(Math.max(r,l.top),-l.top):r;i.style.transform=`translate(${h}px, ${d}px)`},g=()=>{t.isDrag=!1,document.removeEventListener(n,u),document.removeEventListener(a,g)};e.addEventListener(o,(function(e){s.draggable&&(m.startX=c(e).x,m.startY=c(e).y,m.transX=(t=>{const e=getComputedStyle(t).transform;let i=e.match(/^matrix3d\((.+)\)$/);return i?parseFloat(i[1].split(", ")[12]):(i=e.match(/^matrix\((.+)\)$/),i?parseFloat(i[1].split(", ")[4]):0)})(t.image),m.transY=(t=>{const e=getComputedStyle(t).transform;let i=e.match(/^matrix3d\((.+)\)$/);return i?parseFloat(i[1].split(", ")[13]):(i=e.match(/^matrix\((.+)\)$/),i?parseFloat(i[1].split(", ")[5]):0)})(t.image),t.isDrag=!0,document.addEventListener(n,u),document.addEventListener(a,g))}))};class m{constructor(e,i={}){if(!e)throw new Error("The first argument is required.");if(null===r(e))throw new Error("This element is not exist.");this.element=r(e),this.options=Object.assign({},t,(t=>{if(!(t=>"object"==typeof t&&null!==t)(t))return!1;try{const{constructor:e}=t,{prototype:i}=e,{hasOwnProperty:o}=Object.prototype;return e&&i&&o.call(i,"isPrototypeOf")}catch(t){return!1}})(i)&&i),this.init()}init(){const{element:i,options:o}=this;if(i[e])return;i[e]=this;const n=o.src="string"==typeof(a=o.src)&&""!==a?o.src:t.src;var a;const s=i.getAttribute(n);this.create(s)}create(t){if(!t)return;const{element:e}=this,{offsetWidth:i,offsetHeight:o}=e;this.url=t,this.data={},this.data.containerData={width:i,height:o,ratio:i/o},this.mount()}mount(){if(this.mounted)return;const{url:t,data:e,options:i}=this,{containerData:o}=e,{fill:n}=i,a=document.createElement("img");a.classList.add("zoomist-image"),a.src=t,this.image=a;const{naturalWidth:s,naturalHeight:r}=a,c=s/r;let d;"cover"!==n&&"contain"!==n&&"none"!==n&&(i.fill="cover"),"cover"===i.fill&&(d=o.ratio===c?"both":o.ratio>c?"width":"height"),"contain"===i.fill&&(d=o.ratio===c?"both":o.ratio>c?"height":"width");const m="none"===i.fill?s:"both"===d||"width"===d?o.width:o.height*c,u="none"===i.fill?r:"both"===d||"height"===d?o.height:o.width/c,g=(o.width-m)/2,f=(o.height-u)/2;this.data.imageData={naturalWidth:s,naturalHeight:r,width:m,height:u,ratio:c,left:g,top:f},h(a,{width:m,height:u,left:g,top:f}),l(this),this.mounted=!0,this.render()}render(){const{element:t,image:e}=this;t.classList.add("zoomist-container"),t.append(e)}}return Object.assign(m.prototype,d),m}));
